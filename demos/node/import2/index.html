<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/vexflow-examples/css/reset.css">
    <link rel="stylesheet" href="/vexflow-examples/css/theme.css">
    <link rel="stylesheet" href="/vexflow-examples/css/helpers.css">   
    <link rel="stylesheet" href="/vexflow-examples/css/layout.css">
    <link rel="stylesheet" href="/vexflow-examples/css/base.css">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11/styles/github.min.css" media="(prefers-color-scheme: light)">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11/styles/github-dark-dimmed.min.css" media="(prefers-color-scheme: dark)">
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js"></script>
  
  <!-- allow extra tags in the head -->
  
  <title>Import Example 2</title>
</head>
<body>
   <div class="container">
    
      <div class="nav-container">
    <h3 class="nav-title">Examples</h3>
    <div class="site-nav">
  
  

  
    
    
    <div class="section">
      <h3 class="section-header">
        Components
      </h3>
      
        <ul class="section-links">
          
            <li>
              <a href="/vexflow-examples/demos/components/hairpin/" class="">hairpin</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/components/textbracket/" class="">textbracket</a>
            </li>
          
        </ul>
      
    </div>
  
    
    
    <div class="section">
      <h3 class="section-header">
        Entry
      </h3>
      
        <ul class="section-links">
          
            <li>
              <a href="/vexflow-examples/demos/entry/vexflow-bravura.esm/" class="">vexflow-bravura.esm.js</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/entry/vexflow-bravura/" class="">vexflow-bravura.js</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/entry/vexflow-core.esm/" class="">vexflow-core.esm.js</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/entry/vexflow-core/" class="">vexflow-core.js</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/entry/vexflow-debug-with-tests/" class="">vexflow-debug-with-tests.js</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/entry/vexflow-debug/" class="">vexflow-debug.js</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/entry/vexflow.esm/" class="">vexflow.esm.js</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/entry/vexflow/" class="">vexflow.js</a>
            </li>
          
        </ul>
      
    </div>
  
    
    
    <div class="section">
      <h3 class="section-header">
        Fonts
      </h3>
      
        <ul class="section-links">
          
            <li>
              <a href="/vexflow-examples/demos/fonts/async-await/" class="">Async Await</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/fonts/async-promise/" class="">Async Promise</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/fonts/bravura/" class="">Bravura</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/fonts/bravura-score/" class="">Bravura Score</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/fonts/five-staves/" class="">Five Staves</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/fonts/music/" class="">Music</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/fonts/text/" class="">Text</a>
            </li>
          
        </ul>
      
    </div>
  
    
    
    <div class="section">
      <h3 class="section-header">
        Interactivity
      </h3>
      
        <ul class="section-links">
          
            <li>
              <a href="/vexflow-examples/demos/interactivity/ui/" class="">Hover Events</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/interactivity/canvas-interaction/" class="">canvas interactions</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/interactivity/svg-interaction/" class="">svg interactions</a>
            </li>
          
        </ul>
      
    </div>
  
    
    
    <div class="section">
      <h3 class="section-header">
        Modules
      </h3>
      
        <ul class="section-links">
          
            <li>
              <a href="/vexflow-examples/demos/modules/script-tag/" class="">Async Await</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/modules/module/" class="">ES Modules</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/modules/both/" class="">Module and Script</a>
            </li>
          
        </ul>
      
    </div>
  
    
    
    <div class="section">
      <h3 class="section-header">
        Node
      </h3>
      
        <ul class="section-links">
          
            <li>
              <a href="/vexflow-examples/demos/node/canvas/" class="">Canvas</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/node/font-draw/" class="">Font~Draw</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/node/import1/" class="">Import 1</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/node/import2/" class="active">Import 2</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/node/import3/" class="">Import 3</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/node/pdf-canvas/" class="">PDF Canvas</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/node/pdf-svg/" class="">PDF SVG</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/node/require1/" class="">Require 1</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/node/require2/" class="">Require 2</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/node/svg/" class="">SVG</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/node/customcontext/" class="">customContext</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/node/font-load-2/" class="">font-load-2</a>
            </li>
          
        </ul>
      
    </div>
  
    
    
    <div class="section">
      <h3 class="section-header">
        Opentype
      </h3>
      
        <ul class="section-links">
          
            <li>
              <a href="/vexflow-examples/demos/opentype/canvas/" class="">Canvas</a>
            </li>
          
            <li>
              <a href="/vexflow-examples/demos/opentype/load/" class="">Load</a>
            </li>
          
        </ul>
      
    </div>
  
    
    
    <div class="section">
      <h3 class="section-header">
        Worker
      </h3>
      
        <ul class="section-links">
          
            <li>
              <a href="/vexflow-examples/demos/worker/" class="">Using Workers</a>
            </li>
          
        </ul>
      
    </div>
  
</div>

</div>
      

        <main class="main-content">
          <section class="content-wrapper">
            <button id="open-sidebar-btn" class="svg-btn svg-btn--lg">
              <svg xmlns="http://www.w3.org/2000/svg" height="40px" viewBox="0 -960 960 960" width="40px"><path d="M165.13-254.62q-10.68 0-17.9-7.26-7.23-7.26-7.23-18t7.23-17.86q7.22-7.13 17.9-7.13h629.74q10.68 0 17.9 7.26 7.23 7.26 7.23 18t-7.23 17.87q-7.22 7.12-17.9 7.12H165.13Zm0-200.25q-10.68 0-17.9-7.27-7.23-7.26-7.23-17.99 0-10.74 7.23-17.87 7.22-7.13 17.9-7.13h629.74q10.68 0 17.9 7.27 7.23 7.26 7.23 17.99 0 10.74-7.23 17.87-7.22 7.13-17.9 7.13H165.13Zm0-200.26q-10.68 0-17.9-7.26-7.23-7.26-7.23-18t7.23-17.87q7.22-7.12 17.9-7.12h629.74q10.68 0 17.9 7.26 7.23 7.26 7.23 18t-7.23 17.86q-7.22 7.13-17.9 7.13H165.13Z"></path></svg>
          </button>
          

<h1 id="import-example-2" tabindex="-1"><a class="header-anchor" href="#import-example-2">Import Example 2</a></h1>


<div class="code-block">
    <button class="copy-btn svg-btn" type="button" aria-label="Copy code">
    <svg fill="blue" viewBox="0 0 32 32" data-name="Layer 1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><title></title><path d="M27.2,8.22H23.78V5.42A3.42,3.42,0,0,0,20.36,2H5.42A3.42,3.42,0,0,0,2,5.42V20.36a3.43,3.43,0,0,0,3.42,3.42h2.8V27.2A2.81,2.81,0,0,0,11,30H27.2A2.81,2.81,0,0,0,30,27.2V11A2.81,2.81,0,0,0,27.2,8.22ZM5.42,21.91a1.55,1.55,0,0,1-1.55-1.55V5.42A1.54,1.54,0,0,1,5.42,3.87H20.36a1.55,1.55,0,0,1,1.55,1.55v2.8H11A2.81,2.81,0,0,0,8.22,11V21.91ZM28.13,27.2a.93.93,0,0,1-.93.93H11a.93.93,0,0,1-.93-.93V11a.93.93,0,0,1,.93-.93H27.2a.93.93,0,0,1,.93.93Z"></path></g></svg>
    </button>
    <pre><code id="example-code" class="language-javascript">
  
  // Summary:
//   Save scores to portable SVG, with embedded OTF fonts (base64 encoded).
//   This demo is buggy, since the note heads are detached from the stems.
//   Perhaps this is a glyph measurement issue?
//
// Run:
//   node import2.mjs
//
// Press a key to advance to the next command. CTRL+C to quit.
// This demo uses await import(...) to load vexflow.js.

import { default as fs } from &#39;fs&#39;;

import { JSDOM } from &#39;jsdom&#39;;

// Reference to VexFlow, assigned in the step1() function.
let VF;

async function waitForKeyPress() {
  process.stdin.setRawMode(true);
  return new Promise((resolve) =&gt;
    process.stdin.once(&#39;data&#39;, (data) =&gt; {
      // Handle CTRL+C.
      const byteArray = [...data];
      if (byteArray.length &gt; 0 &amp;&amp; byteArray[0] === 3) {
        console.log(&#39;^C&#39;);
        process.exit(1);
      }
      process.stdin.setRawMode(false);
      resolve();
    })
  );
}

function svgScore(fontName) {
  const { Renderer, Stave, StaveNote, Formatter } = VF;
  const dom = new JSDOM(&#39;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;div id=&#34;vf&#34;&gt;&lt;/div&gt;&lt;body&gt;&lt;/html&gt;&#39;);

  global.document = dom.window.document;

  // Create an SVG renderer and attach it to the DIV element named &#34;vf&#34;.
  const div = document.getElementById(&#39;vf&#39;);
  const renderer = new Renderer(div, Renderer.Backends.SVG);

  const w = 800;
  const h = 600;

  // Configure the rendering context.
  renderer.resize(w, h);
  const ctx = renderer.getContext();
  ctx.setFillStyle(&#39;#ddd&#39;);
  ctx.fillRect(0, 0, w, h);
  ctx.setFillStyle(&#39;#222&#39;);

  const stave = new Stave(10, 40, 400);

  stave.addClef(&#39;treble&#39;).addTimeSignature(&#39;4/4&#39;);

  const notes = [
    new StaveNote({ keys: [&#39;c/4&#39;, &#39;e/4&#39;], duration: &#39;h&#39; }),
    new StaveNote({ keys: [&#39;c/4&#39;, &#39;e/4&#39;, &#39;c/5&#39;], duration: &#39;h&#39; }),
  ];

  stave.setContext(ctx).drawWithStyle();
  Formatter.FormatAndDraw(ctx, stave, notes);

  // const svg = div.innerHTML.replace(&#39;&lt;svg &#39;, &#39;&lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34; &#39;);

  const svg = div.childNodes[0];
  svg.setAttribute(&#39;xmlns&#39;, &#39;http://www.w3.org/2000/svg&#39;);
  insertFont(svg, fontName);

  return svg.outerHTML;
}

function insertFont(svgElement, fontName) {
  const fontNameLowerCase = fontName.toLowerCase();
  const fontsDir = &#39;../../node_modules/@vexflow-fonts/&#39;;
  const fontFile = fs.readFileSync(fontsDir + fontNameLowerCase + &#39;/&#39; + fontNameLowerCase + &#39;.otf&#39;);
  const fontBase64 = fontFile.toString(&#39;base64&#39;);

  const defsElement = document.createElementNS(&#39;http://www.w3.org/2000/svg&#39;, &#39;defs&#39;);
  const defsString = `
&lt;style&gt;
  &lt;![CDATA[
@font-face {
  font-family: &#34;${fontName}&#34;;
  src: url(&#34;data:font/opentype;base64,${fontBase64}&#34;);
}
  ]]&gt;
&lt;/style&gt;`;
  defsElement.innerHTML = defsString;
  svgElement.insertBefore(defsElement, svgElement.firstChild);
}

async function step0() {
  console.log(&#39;Press any key to run the next command. CTRL+C to quit.&#39;);
  console.log(&#39;\n==================================\n&#39;);
  console.log(&#39;&gt;&gt;&gt; load vexflow ...&#39;);

  // Make sure the output folder exists.
  if (!fs.existsSync(&#39;./output/&#39;)) {
    fs.mkdirSync(&#39;./output/&#39;);
  }
}

async function step1() {
  const { VexFlow } = await import(&#39;vexflow&#39;);
  VF = VexFlow;

  console.log(&#39;Loaded VexFlow Version: &#39;, VF.BUILD.VERSION, &#39; Build: &#39;, VF.BUILD.ID);
  console.log(&#39;The default music font stack is:&#39;, VF.getFonts());

  console.log(&#39;\n==================================\n&#39;);
  console.log(&#39;&gt;&gt;&gt; Bravura...&#39;);
}

async function step2() {
  VF.setFonts(&#39;Bravura&#39;, &#39;Academico&#39;);
  console.log(&#39;The current music font stack is:&#39;, VF.getFonts());
  fs.writeFileSync(&#39;output/score_bravura.svg&#39;, svgScore(&#39;Bravura&#39;));

  console.log(&#39;\n==================================\n&#39;);
  console.log(&#39;&gt;&gt;&gt; Petaluma...&#39;);
}

async function step3() {
  VF.setFonts(&#39;Petaluma&#39;, &#39;Petaluma Script&#39;);
  console.log(&#39;The current music font stack is:&#39;, VF.getFonts());
  fs.writeFileSync(&#39;output/score_petaluma.svg&#39;, svgScore(&#39;Petaluma&#39;));

  console.log(&#39;\n==================================\n&#39;);
  console.log(&#39;&gt;&gt;&gt; Gonville...&#39;);
}

async function step4() {
  VF.setFonts(&#39;Gonville&#39;, &#39;Academico&#39;);
  console.log(&#39;The current music font stack is:&#39;, VF.getFonts());
  fs.writeFileSync(&#39;output/score_gonville.svg&#39;, svgScore(&#39;Gonville&#39;));

  console.log(&#39;\n==================================\n&#39;);
  console.log(&#39;&gt;&gt;&gt; Leland...&#39;);
}

async function step5() {
  VF.setFonts(&#39;Leland&#39;, &#39;Edwin&#39;);
  console.log(&#39;The current music font stack is:&#39;, VF.getFonts());
  fs.writeFileSync(&#39;output/score_leland.svg&#39;, svgScore(&#39;Leland&#39;));

  console.log(&#39;\n==================================\n&#39;);
  console.log(&#39;DONE!&#39;);
}

async function runAllSteps() {
  await step0();
  await waitForKeyPress();
  await step1();
  await waitForKeyPress();
  await step2();
  await waitForKeyPress();
  await step3();
  await waitForKeyPress();
  await step4();
  await waitForKeyPress();
  await step5();
}

runAllSteps().then(() =&gt; process.exit(0));


</code></pre>
  </div>
          </section>
        </main>
        <div class="overlay" id="overlay"></div>
    </div>
    <script>
        const toggleButton = document.getElementById('open-sidebar-btn');
        const overlay = document.getElementById('overlay');
        const themeSelector = document.getElementById('theme-select')

        toggleButton.addEventListener('click', () => {
        document.body.classList.toggle('nav-open');
        });    

        overlay.addEventListener('click', () => {
        document.body.classList.remove('nav-open');
        });
        
        // themeSelector.addEventListener('click', () => {
        //     console.log("pressed")
        //     if (document.documentElement.getAttribute('data-theme') == 'light'){
        //         document.documentElement.setAttribute('data-theme', 'dark')
        //     }
        //     else {
        //         document.documentElement.setAttribute('data-theme', 'light')
        //     }
        // })

    </script>
    <script>
        // works pretty well, on page resize could be reran when different toc is shown
document.addEventListener("DOMContentLoaded", () => {
  const allTOCLinks = document.querySelectorAll(".toc a");
  const headings = Array.from(allTOCLinks)
    .map(link => document.querySelector(decodeURIComponent(link.getAttribute("href"))))
    .filter(Boolean);

  const isVisible = el => !!(el.offsetWidth || el.offsetHeight || el.getClientRects().length);

  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const id = entry.target.getAttribute("id");

        // Remove active from all visible TOCs
        allTOCLinks.forEach(link => {
          if (isVisible(link)) link.classList.remove("active");
        });

        // Add active to visible link matching this heading
        const matchingLinks = Array.from(document.querySelectorAll(`.toc a[href="#${id}"]`));
        matchingLinks.forEach(link => {
          if (isVisible(link)) link.classList.add("active");
        });
      }
    });
  }, {
    // rootMargin: "-50% 0% -40% 0%",
    threshold: 0.1
  });

  headings.forEach(h => observer.observe(h));
});
      </script>   
      
      <script>
          hljs.highlightAll();
      </script>
    
    <script>
      document.addEventListener("click", (e) => {
        // Only run on clicks of copy buttons
        const btn = e.target.closest(".copy-btn");
        if (!btn) return;

        // Find the nearest code block wrapper
        const block = e.target.closest(".code-block");
        if (!block) return;

        // Grab the code text (innerText so spans from highlighting are ignored)
        const codeEl = block.querySelector("code");
        const text   = codeEl.innerText;

        // Copy it
        navigator.clipboard.writeText(text);
      });
    </script>
</body>
</html>